<!DOCTYPE html>
<meta charset="utf-8" />

<!-- Load d3.js -->
<script src="https://d3js.org/d3.v4.js"></script>

<!-- Create a div where the graph will take place -->
<div class="d3 analytics chartviews">
    <svg width="900" height="500"></svg>
</div>
<script>
const data = {"DataFeed":{"Columns":[{"Category":"Metric","Name":"m_page_loads_per_visit","Type":"Decimal","CustomerType":"Decimal","Label":"Page views / visit","Description":"Average number of page loads that occur during a visit. Calculation: page views / visits","Pie":false,"Precision":2,"Filterable":true,"Summable":false},{"Category":"Dimension","Name":"d_evo_day","Type":"Date","CustomerType":"Time","Label":"Day","Description":"","Filterable":true}],"Rows":[{"Rows":{"Rows":[{"m_page_loads_per_visit":1.78589,"d_evo_day":"2022-02-21"},{"m_page_loads_per_visit":1.745874,"d_evo_day":"2022-02-22"},{"m_page_loads_per_visit":1.749678,"d_evo_day":"2022-02-23"},{"m_page_loads_per_visit":1.666065,"d_evo_day":"2022-02-24"},{"m_page_loads_per_visit":1.864474,"d_evo_day":"2022-02-25"},{"m_page_loads_per_visit":1.874401,"d_evo_day":"2022-02-26"},{"m_page_loads_per_visit":1.810972,"d_evo_day":"2022-02-27"}],"m_page_loads_per_visit":"0"}}],"Context":{"Periods":[{"Value":"2022-02-21,2022-02-27"}]}}};
const simple = data.DataFeed.Rows[0].Rows.Rows;

const svg = d3.select('svg');
const margin = {
    top: 20,
    right: 20,
    bottom: 30,
    left: 50,
};
const width = +svg.attr('width') - margin.left - margin.right;
const height = +svg.attr('height') - margin.top - margin.bottom;
const g = svg.append('g').attr('transform', `translate(${margin.left},${margin.top})`);

const parseTime = d3.timeParse('%Y-%m-%d');
simple.forEach(function(d){
d.d_evo_day = parseTime(d.d_evo_day);
});

const x = d3.scaleTime().rangeRound([0, width, ]);
const y = d3.scaleLinear().rangeRound([height, 0, ]);

const line = d3.line()
    .x(d => x(d.d_evo_day))
    .y(d => y(d.m_page_loads_per_visit));

x.domain(d3.extent(simple, d => d.d_evo_day));
y.domain(d3.extent(simple, d => d.m_page_loads_per_visit));

g.append('g')
    .attr('transform', `translate(0,${height})`)
    .call(d3.axisBottom(x))
    .select('.domain')
    .remove();

g.append('g')
    .call(d3.axisLeft(y))
    .append('text')
    .attr('fill', '#000')
    .attr('transform', 'rotate(-90)')
    .attr('y', 6)
    .attr('dy', '0.71em')
    .attr('text-anchor', 'end')
    .text('Page views / visit');

g.append('path')
    .datum(simple)
    .attr('fill', 'none')
    .attr('stroke', 'steelblue')
    .attr('stroke-linejoin', 'round')
    .attr('stroke-linecap', 'round')
    .attr('stroke-width', 1.5)
    .attr('d', line);
</script>
